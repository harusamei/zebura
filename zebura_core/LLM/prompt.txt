# 存放任务指令模板，格式为：<TASK: xxx> ... </TASK>
# ignore #开头的行

<TASK: rewrite>
# 将多轮对话，重写为一条查询语句
# 例如请提供您想要查询的表的名称， could you please provide the name of the table you want to query? 

During a conversation, when a user questions for database and the agent provides search results, if the agent cannot find relevant data, it will prompt the user for more specific details. Based on the conversation and the subsequent message from the human, rewrite the message to be a standalone and detailed question that captures all relevant context from the conversation. Ensure the rewritten question:
1. Maintain the original intent of the follow-up message.
2. Rewrite the conversation directly as a question for database, without prompting the user to provide more specific information.
3. Capture information pertaining to tables, fields, and query conditions discussed in the conversation.
4. If the true intent of the follow-up message is unclear, refrain from making modifications to prevent generating an incorrect query.
5. Ensure the length of the rewritten query does not significantly exceed that of the follow-up message to preserve the original intent.
6. Avoid using the Agent's responses directly in formulating the rewritten query. Prioritize referencing the Human's historical questions.

Conversation History (Sorted by request time from most recent to oldest):
{history_context}

Follow Up Input: 
user: {query}

NOTE: DO NOT prompt the user for additional specific information.
Refined Standalone Question:
</TASK>

<TASK: nl2sql_classic>
You are a programming assistant, and your task is to convert user’s natural language questions into executable SQL queries. 
Given the database schema structures, including table names, column names and their data types, and the relationships between tables (foreign keys), for the following user input question, you need to:
1. Language Parsing:
- Extract key entities, such as table names and column names, from the input question.
- Identify SQL keywords and clauses required to construct the query (e.g., SELECT, WHERE, JOIN, ORDER BY).
2. Convert to a Valid SQL Statement: 
- Convert parsed components into a valid SQL statement.
- Ensure correct syntax and logical order of SQL clauses.
3. Handle edge cases or bad cases:
- Handle edge cases, such as ambiguous or incomplete questions, by providing the best possible SQL guess or requesting clarification.
- Output NOSQL and suggestions for improving the input question if it cannot be directly converted into SQL.

Examples of two output formats:
1. 
   ```sql
   SELECT brand, COUNT(DISTINCT product_cate1) AS category_count
   FROM products
   GROUP BY brand;
   ```
2. 
 NOSQL, To provide you with the average price of laptops, I would need more specific criteria or filters to narrow down the selection of laptops. 

Database schema structures:
{dbSchema}

</TASK>

<TASK: term_expansion>
# 术语扩展
Given the following keywords, generate a set of vocabulary expansions for each keyword including synonyms, related terms, spelling variants, conceptual expansion and translation (If the original word is in Chinese, translate it into English; if it is in English, translate it into Chinese). 
Ensure to provide a diverse set of expansions to enrich the vocabulary.
Examples of output
[Innovation] 
- Synonym Expansion: Creativity OR Originality OR Novelty OR Ingenuity 
- Related Terms Expansion: Invention OR Breakthrough OR Disruption OR Modernization OR Revolution 
- Spelling Variants: Innovación (Spanish) OR Innovation (French) OR Innovazione (Italian)
- Conceptual Expansion: Technological Advancements OR Process Improvements OR Creative Solutions OR Business Transformation
- Translation: 创新
[Technology]
- Synonym Expansion: Tech OR Engineering OR Applied Science OR High-tech
- Related Terms Expansion: Gadgets OR Devices OR Digital Tools OR Software OR Hardware
- Spelling Variants: Technologie (German) OR Tecnología (Spanish) OR Tecnologia (Italian)
- Conceptual Expansion: Digital Transformation OR Innovation Enablers OR Modern Systems OR Computational Advancements
- Translation: 技术
Please generate expansions for each keyword following the format above.
</TASK>

# 根据db schema生成查询DB的自然语言问题
<TASK: db2nl>
You are provided with a detailed schema of a relational database. This schema includes the names of tables, their columns, data types, and relationships between tables (foreign keys). Your task is to generate various natural language questions that could be asked to query information from this database. The questions should cover a wide range of query types, including but not limited to data retrieval, aggregations, updates, and joins.

Instructions:

Carefully read the provided database schema to understand the structure and relationships between tables.
Generate a set of natural language questions based on the schema. Aim for diversity in the types of questions, including:
Simple retrieval questions
Aggregation and summary questions
Update or modification questions
Questions involving joins across multiple tables
Conditional retrieval questions
Ensure the questions are clear and unambiguous, reflecting typical queries a user might ask to interact with this database.

For each of the above natural language questions in Chinese, convert them into corresponding SQL queries

Example Database Schema:

Input: 
database schema:

1. Customers
CustomerID
Name 
Email 
PhoneNumber 

2. Orders
OrderID
OrderDate 
CustomerID 
TotalAmount 

3. Products
ProductID 
ProductName 
Price 

4. OrderDetails
OrderDetailID
OrderID
ProductID
Quantity
Subtotal

Output:  
Natural Language Question: 找到所有客户的名称和电子邮件地址。
SQL Query:
SELECT Name, Email
FROM Customers;

Natural Language Question: 找出在2024年5月下订单的客户ID和订单ID。
SQL Query:
SELECT CustomerID, OrderID
FROM Orders
WHERE OrderDate BETWEEN '2024-05-01' AND '2024-05-31';

Natural Language Question: 获取所有订单的总金额大于1000的订单ID和总金额。
SQL Query:
SELECT OrderID, TotalAmount
FROM Orders
WHERE TotalAmount > 1000;

Now, generate a comprehensive list of natural language questions and SQL queries based on the provided db schema.
Note, natural language questions must be related to the database schema, and the fields of the SQL query must be within the database schema.
</TASK>

<TASK: db2sql>
You will be provided with a database schema. Your task is to generate a diverse set of SQL queries based on the given schema. 
Ensure that the generated queries involve different tables and fields from the schema, and include various SQL operations (e.g., SELECT, INSERT, UPDATE, DELETE, etc.). 
Provide detailed queries and make each query unique and meaningful. 

Please generate the following types of SQL queries:

A simple SELECT query including multiple fields from one table.
A query with a JOIN operation involving at least two tables.
A SELECT query with a subquery.
An INSERT query to insert data into a table.
An UPDATE query to update specific records in a table.
A DELETE query to delete specific records from a table.
A query including aggregate functions (e.g., COUNT, SUM, AVG, etc.).
A query with GROUP BY and HAVING clauses.
Please ensure that each query aligns with the provided database schema.

Below is the detailed information of the schema:
</TASK>
