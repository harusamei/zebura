# 存放任务指令模板，格式为：<TASK: xxx> ... </TASK>
# ignore #开头的行

<TASK: rewrite>
# 将多轮对话，重写为一条查询语句
Given a conversation (between Human and Assistant) and a follow up message from Human, using the prior knowledge relationships, rewrite the message to be a standalone and detailed question that captures all relevant context from the conversation. Ensure the rewritten question:
1. Preserves the original intent of the follow-up message.
2. If the true intent of the follow-up message cannot be determined, make no modifications to avoid generating an incorrect question.
3. The length of the rewritten question should not increase significantly compared to the follow-up message, to avoid altering the original intent.
4. Do not directly use the content of the Assistant's responses to form the rewritten question. Prioritize referring to the information of the Human's historical question.
5. Maintains the same language as the follow-up message (e.g., reply in Chinese if the question was asked in Chinese and in English if it was asked in English).

Chat History (Sorted by request time from most recent to oldest):
{history_context}

Follow Up Input: 
{query}
**NOTE:** Please respond in SAME language as the input message.

Refined Standalone Question:
</TASK>

<TASK: nl2SQL_classic>
You are a programming assistant, and your task is to convert user’s natural language questions into executable SQL queries. 
Given the database schema structures, including table names, column names and their data types, and the relationships between tables (foreign keys), for the following user input question, you need to:
1. Language Parsing:
- Extract key entities, such as table names and column names, from the input question.
- Identify SQL keywords and clauses required to construct the query (e.g., SELECT, WHERE, JOIN, ORDER BY).
2. Convert to a Valid SQL Statement: 
- Convert parsed components into a valid SQL statement.
- Ensure correct syntax and logical order of SQL clauses.
3. Handle edge cases or bad cases:
- Handle edge cases, such as ambiguous or incomplete questions, by providing the best possible SQL guess or requesting clarification.
- Output NOSQL and suggestions for improving the input question if it cannot be directly converted into SQL.

Format:
   Input: [User's natural language question]
   Output: [Converted SQL statement in code format] or [NOSQL, suggestions for improving the input question]

Database schema structures:
{dbSchema}

</TASK>

# 根据db schema生成查询DB的自然语言问题
<TASK: db2nl>
You are provided with a detailed schema of a relational database. This schema includes the names of tables, their columns, data types, and relationships between tables (foreign keys). Your task is to generate various natural language questions that could be asked to query information from this database. The questions should cover a wide range of query types, including but not limited to data retrieval, aggregations, updates, and joins.

Instructions:

Carefully read the provided database schema to understand the structure and relationships between tables.
Generate a set of natural language questions based on the schema. Aim for diversity in the types of questions, including:
Simple retrieval questions
Aggregation and summary questions
Update or modification questions
Questions involving joins across multiple tables
Conditional retrieval questions
Ensure the questions are clear and unambiguous, reflecting typical queries a user might ask to interact with this database.

For each of the above natural language questions in Chinese, convert them into corresponding SQL queries

Example Database Schema:

Input: 
database schema:

1. Customers
CustomerID
Name 
Email 
PhoneNumber 

2. Orders
OrderID
OrderDate 
CustomerID 
TotalAmount 

3. Products
ProductID 
ProductName 
Price 

4. OrderDetails
OrderDetailID
OrderID
ProductID
Quantity
Subtotal

Output:  
Natural Language Question: 找到所有客户的名称和电子邮件地址。
SQL Query:
SELECT Name, Email
FROM Customers;

Natural Language Question: 找出在2024年5月下订单的客户ID和订单ID。
SQL Query:
SELECT CustomerID, OrderID
FROM Orders
WHERE OrderDate BETWEEN '2024-05-01' AND '2024-05-31';

Natural Language Question: 获取所有订单的总金额大于1000的订单ID和总金额。
SQL Query:
SELECT OrderID, TotalAmount
FROM Orders
WHERE TotalAmount > 1000;

Now, generate a comprehensive list of natural language questions and SQL queries based on the provided db schema.
Note, natural language questions must be related to the database schema, and the fields of the SQL query must be within the database schema.
</TASK>

<TASK: db2sql>
You will be provided with a database schema. Your task is to generate a diverse set of SQL queries based on the given schema. 
Ensure that the generated queries involve different tables and fields from the schema, and include various SQL operations (e.g., SELECT, INSERT, UPDATE, DELETE, etc.). 
Provide detailed queries and make each query unique and meaningful. 

Please generate the following types of SQL queries:

A simple SELECT query including multiple fields from one table.
A query with a JOIN operation involving at least two tables.
A SELECT query with a subquery.
An INSERT query to insert data into a table.
An UPDATE query to update specific records in a table.
A DELETE query to delete specific records from a table.
A query including aggregate functions (e.g., COUNT, SUM, AVG, etc.).
A query with GROUP BY and HAVING clauses.
Please ensure that each query aligns with the provided database schema.

Below is the detailed information of the schema:
</TASK>
